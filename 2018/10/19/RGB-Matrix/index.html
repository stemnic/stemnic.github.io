<!DOCTYPE html>
<html lang=En>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="TLDRThis is a 8x8 led matrix which uses a ATXMega64A4 to draw 8x8 bitmap image in RGB which can be sequenced into animations. All code and PCB design files are available at my GitHub Page. Motivation">
<meta property="og:type" content="article">
<meta property="og:title" content="Creating a RGB 8x8 Led Matrix">
<meta property="og:url" content="https://osme.me/2018/10/19/RGB-Matrix/index.html">
<meta property="og:site_name" content="The Osme Blog">
<meta property="og:description" content="TLDRThis is a 8x8 led matrix which uses a ATXMega64A4 to draw 8x8 bitmap image in RGB which can be sequenced into animations. All code and PCB design files are available at my GitHub Page. Motivation">
<meta property="og:locale" content="English">
<meta property="og:image" content="https://osme.me/2018/10/19/RGB-Matrix/intro_promo.gif">
<meta property="og:image" content="https://osme.me/2018/10/19/RGB-Matrix/8x8_RGB_matrix_panel.jpg">
<meta property="og:image" content="https://osme.me/2018/10/19/RGB-Matrix/2088RGB-5-datasheet.jpg">
<meta property="og:image" content="https://osme.me/2018/10/19/RGB-Matrix/Highside_switch.JPG">
<meta property="og:image" content="https://osme.me/2018/10/19/RGB-Matrix/lowside_nmos.jpg">
<meta property="og:image" content="https://osme.me/2018/10/19/RGB-Matrix/pcb_up.jpg">
<meta property="og:image" content="https://osme.me/2018/10/19/RGB-Matrix/pcb_assembled.jpg">
<meta property="og:updated_time" content="2018-10-19T00:10:39.385Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Creating a RGB 8x8 Led Matrix">
<meta name="twitter:description" content="TLDRThis is a 8x8 led matrix which uses a ATXMega64A4 to draw 8x8 bitmap image in RGB which can be sequenced into animations. All code and PCB design files are available at my GitHub Page. Motivation">
<meta name="twitter:image" content="https://osme.me/2018/10/19/RGB-Matrix/intro_promo.gif">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Creating a RGB 8x8 Led Matrix</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/stemnic">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://osme.me/2018/10/19/RGB-Matrix/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://osme.me/2018/10/19/RGB-Matrix/&text=Creating a RGB 8x8 Led Matrix"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://osme.me/2018/10/19/RGB-Matrix/&is_video=false&description=Creating a RGB 8x8 Led Matrix"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Creating a RGB 8x8 Led Matrix&body=Check out this article: https://osme.me/2018/10/19/RGB-Matrix/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://osme.me/2018/10/19/RGB-Matrix/&name=Creating a RGB 8x8 Led Matrix&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#TLDR"><span class="toc-number">1.</span> <span class="toc-text">TLDR</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Motivation"><span class="toc-number"></span> <span class="toc-text">Motivation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Design-Phase"><span class="toc-number"></span> <span class="toc-text">Design Phase</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pin-switching-NMOS-amp-PMOS-transistors"><span class="toc-number">1.</span> <span class="toc-text">Pin switching (NMOS &amp; PMOS transistors)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Designing-the-circuit"><span class="toc-number">2.</span> <span class="toc-text">Designing the circuit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Software"><span class="toc-number"></span> <span class="toc-text">Software</span></a>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Creating a RGB 8x8 Led Matrix
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">The Osme Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-10-19T00:10:39.000Z" itemprop="datePublished">2018-10-19</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <img src="/2018/10/19/RGB-Matrix/intro_promo.gif" title="Well would you look at that">
<h3 id="TLDR"><a href="#TLDR" class="headerlink" title="TLDR"></a>TLDR</h3><p>This is a 8x8 led matrix which uses a ATXMega64A4 to draw 8x8 bitmap image in RGB which can be sequenced into animations. All code and PCB design files are available at my <a href="https://github.com/stemnic" target="_blank" rel="noopener">GitHub Page</a>.</p>
<h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><p>In the student organization Omega for people studying Electrical Engineering at NTNU there has been a long tradition with making led plates displaying the emblem of the organization. It is today made up of red LEDs which are shaped into an omega sign. This would be worn at formal ceremonies or social happenings organized by Omega and would serve as a party gimmick.</p>
<p>So naturally when I became a member I wanted to do something more and create something that could also improve my understanding of electronics. I decided to create a RGB led matrix instead which should have these criteriaâ€™s</p>
<ul>
<li><p>Programmable</p>
</li>
<li><p>Modular</p>
</li>
<li><p>And ofc flashy</p>
</li>
</ul>
<h2 id="Design-Phase"><a href="#Design-Phase" class="headerlink" title="Design Phase"></a>Design Phase</h2><p>After some searching online I found premade 8x8 RGB matrix on eBay for about $3 USD, of course I could have made this myself but I decided to use my energy on the driver board. From there the design was based around the pins of the panel and confined within its dimensions.<br><img src="/2018/10/19/RGB-Matrix/8x8_RGB_matrix_panel.jpg" title="The 8x8 RGB matrix panel"></p>
<p>But to drive these I needed a way to switch the ground and power pins of the matrix on and off individually such that it was possible to control each led and colour separately according to its schematic.</p>
<img src="/2018/10/19/RGB-Matrix/2088RGB-5-datasheet.jpg" title="Schematics to the matrix panel">
<p>As the brain of the whole construction I decided to use a ATXMega64A4-AU not because it has any specs special features, I just had it handy. So most microcontrollers will work for the same purpose.</p>
<h3 id="Pin-switching-NMOS-amp-PMOS-transistors"><a href="#Pin-switching-NMOS-amp-PMOS-transistors" class="headerlink" title="Pin switching (NMOS &amp; PMOS transistors)"></a>Pin switching (NMOS &amp; PMOS transistors)</h3><p>Since the digital signal coming from the microcontroller will be 3.3V there will be no problem switching an NMOS transistor on or off on the ground pins, since there will be no voltage drop from the source gate to ground.</p>
<p>Simply put the voltage on gate must be higher than the voltage drops from drain to ground. And also maintain a difference higher than the threshold voltage given in the datasheet.<br>$V_{ threshold }&lt;(V_{gate}- V_{source})$</p>
<p>However, the $V_{cc}$ (power supply voltage) will not work with the same design as the voltage drop across the source pin will be higher due to the LEDs it is supplying resulting it not being able to switch. A solution to this is to use a PMOS and an NMOS transistor together and create something called a high side switch. This will use the $V_{cc}$ voltage to switch on the PMOS transistor and a NMOS transistor controlled by the microcontroller to pull this control signal down to ground to turn<br>the PMOS transistor off.</p>
<h3 id="Designing-the-circuit"><a href="#Designing-the-circuit" class="headerlink" title="Designing the circuit"></a>Designing the circuit</h3><p>As mentioned before design files are available on my GitHub with the corresponding component values. We build on the concept to use NMOS transistors to pull our led matrix pins down to ground. And PMOS in combination with NMOS transistors todo high side switching.</p>
<img src="/2018/10/19/RGB-Matrix/Highside_switch.JPG" title="Highside switcher">
<img src="/2018/10/19/RGB-Matrix/lowside_nmos.jpg" title="Lowside switcher">
<p>A voltage regulator is used to takes the battery voltage down to 3V so we donâ€™t fry the microcontroller.</p>
<p>After drawing the circuit in Altium Designer and ordering the PCB from China we can finally begin assembling and programming the microcontroller</p>
<img src="/2018/10/19/RGB-Matrix/pcb_up.jpg" title="Top of PCB">
<img src="/2018/10/19/RGB-Matrix/pcb_assembled.jpg" title="Assembled PCB">
<h2 id="Software"><a href="#Software" class="headerlink" title="Software"></a>Software</h2><p>For us to obtain the desired effect we need a way to control every pin connected to our transistors with a refresh rate that makes an animation. Pulse-Width Modulation (PWM) is a good way to control these pins, however the ATXMega64A4 does not have 32 PWM pins so we need to resort to something called software PWM. Rather then using dedicated hardware modules for switching on and off pins we use an internal timer on the microcontroller which counts to a certain value in a time based on the clock frequency of the microcontroller.</p>
<p>Now since we can switch on &amp; off pins based on a time interval, we use this to draw one of the eight rows on the led matrix. The animation is retrieved from a 8x8 bit map array which contains each image to be displayed on the led matrix where each row on the bitmap is drawn every time our internal timer reaches it set limit.<br>You can find my microcontroller code with my design files on GitHub.</p>
<p>Thank you for reading my wall of text, and hope you found it interesting :)</p>
<p>â€“ O.S.</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/stemnic">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#TLDR"><span class="toc-number">1.</span> <span class="toc-text">TLDR</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Motivation"><span class="toc-number"></span> <span class="toc-text">Motivation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Design-Phase"><span class="toc-number"></span> <span class="toc-text">Design Phase</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Pin-switching-NMOS-amp-PMOS-transistors"><span class="toc-number">1.</span> <span class="toc-text">Pin switching (NMOS &amp; PMOS transistors)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Designing-the-circuit"><span class="toc-number">2.</span> <span class="toc-text">Designing the circuit</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Software"><span class="toc-number"></span> <span class="toc-text">Software</span></a>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://osme.me/2018/10/19/RGB-Matrix/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://osme.me/2018/10/19/RGB-Matrix/&text=Creating a RGB 8x8 Led Matrix"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://osme.me/2018/10/19/RGB-Matrix/&is_video=false&description=Creating a RGB 8x8 Led Matrix"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Creating a RGB 8x8 Led Matrix&body=Check out this article: https://osme.me/2018/10/19/RGB-Matrix/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://osme.me/2018/10/19/RGB-Matrix/&title=Creating a RGB 8x8 Led Matrix"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://osme.me/2018/10/19/RGB-Matrix/&name=Creating a RGB 8x8 Led Matrix&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Ole Sivert Aarhaug
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/stemnic">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


